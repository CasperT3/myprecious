apiVersion: v1
kind: PersistentVolume
metadata:
  name: storagehub-{{ .Release.Name }}
  labels:
    name: storagehub-{{ .Release.Name }}
  annotations:
    pv.kubernetes.io/provisioned-by: nfs.csi.k8s.io
spec:
  accessModes:
  - ReadWriteMany
  capacity:
    storage: 1Gi # doesn't matter, is used to match with the PVC
  storageClassName: nfs-csi
  mountOptions:
    - nfsvers=4.1
  persistentVolumeReclaimPolicy: Delete
  csi:
    driver: nfs.csi.k8s.io
    # volumeHandle format: {nfs-server-address}#{sub-dir-name}#{share-name}
    # make sure this value is unique for every share in the cluster
    volumeHandle: storagehub.{{ .Release.Namespace }}.svc.cluster.local/storage##
    volumeAttributes:
      server: storagehub.{{ .Release.Namespace }}.svc.cluster.local
      share: /

    # driver: smb.csi.k8s.io
    # readOnly: false
    # volumeHandle: storagehub.{{ .Release.Namespace }}.svc.cluster.local/storage##
    # volumeAttributes:
    #   source: "//storagehub.{{ .Release.Namespace }}.svc.cluster.local/storage"
    # nodeStageSecretRef:
    #   name: credentials-storagehub
    #   namespace: csi-smb