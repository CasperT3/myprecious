apiVersion: traefik.io/v1alpha1
kind: Middleware
metadata:
  name: {{ .Release.Name }}-inflightreq-streaming
spec:
  inFlightReq:
    {{ if .Values.plexhobbit.enabled }}
    amount: 4
    {{ if .Values.plexranger.enabled }}
    amount: 8
    {{ else if .Values.plexhalfling.enabled }}
    amount: 16
    {{ else if .Values.plexnazgul.enabled }}
    amount: 16
    {{ else }}
    amount: 2 # 10 per stream
    {{ end }}