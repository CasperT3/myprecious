{{ if .Values.cinesync.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: cinesync-env
data:
  SOURCE_DIR: {{ with (list)}}
    {{- if $.Values.zurg.enabled -}}         {{- append . "/storage/realdebrid-zurg/__all__" -}}     {{- end -}}
    {{- if $.Values.rclonealldebrid.enabled -}} {{- append . "/storage/alldebrid/magnets" -}}        {{- end -}}
    {{- if $.Values.rclonetorbox.enabled -}}    {{- append . "/storage/torbox" -}}                   {{- end -}}
    {{- if $.Values.rclonedebridlink.enabled -}}{{- append . "/storage/debridlink" -}}               {{- end -}}
    {{- if $.Values.rclonepremiumize.enabled -}}{{- append . "/storage/premiumize" -}}               {{- end -}}
    {{- join "," . | trimSuffix "," -}}
  {{- end }} 
  DESTINATION_DIR: /storage/symlinks
  RCLONE_MOUNT: "true" # seems to hang with the way we do our mounts
  ENABLE_PLEX_UPDATE: "true"
  PLEX_URL: http://plex:32400
{{ end }}