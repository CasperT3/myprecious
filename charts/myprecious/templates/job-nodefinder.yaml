# This job is intended to start upon first installation, "anchoring" all of the replicationdestination restores to the desired node
apiVersion: batch/v1
kind: Job
metadata:
  name: nodefinder
  labels:
    app.elfhosted.com/name: nodefinder
  annotations:
    helm.sh/hook: pre-install
spec:
  template:
    metadata:
      labels:
        app.elfhosted.com/name: nodefinder
    spec:
      containers:
      - name: "nodefinder"
        command: [ "/usr/bin/sleep" ]
        args: [ "5m" ]
        image: ghcr.io/elfhosted/tooling:focal-20240530@sha256:458d1f3b54e9455b5cdad3c341d6853a6fdd75ac3f1120931ca3c09ac4b588de
        {{- if .Values.zurghobbit.enabled  }}
        resources: {{ .Values.zurghobbit.resources }}
        tolerations: {{ .Values.zurghobbit.tolerations }}
        affinity: {{ .Values.zurghobbit.affinity }}
        {{- else if .Values.zurgplus.enabled }}
        resources: {{ .Values.zurgplus.resources }}
        tolerations: {{ .Values.zurgplus.tolerations }}
        affinity: {{ .Values.zurgplus.affinity }}
        {{- else }}
        resources: {{ .Values.zurg.resources }}
        tolerations: {{ .Values.zurg.tolerations }}
        affinity: {{ .Values.zurg.affinity }}
        {{- end }}
